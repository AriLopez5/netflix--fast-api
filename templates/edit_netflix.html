{% extends "base.html" %}
{% block content %} 
<div class="form-container">
    <h1>Editar Película/Serie</h1>
    
    <form method="post" action="/do_edit_netflix" enctype="application/x-www-form-urlencoded">
        <div class="form-group">
            <label for="id">Selecciona la película/serie a editar:</label>
            <select id="id" name="id" required onchange="loadItemData()">
                <option value="">-- Selecciona --</option>
                {% for item in netflix %}
                <option value="{{ item.ID }}" 
                        data-tipo="{{ item.Tipo }}" 
                        data-nombre="{{ item.Nombre }}" 
                        data-genero="{{ item.Genero or '' }}" 
                        data-calificacion="{{ item.Calificacion or '' }}" 
                        data-visto="{{ 'si' if item.Visto else 'no' }}" 
                        data-nota="{{ item.Nota or '' }}">
                    {{ item.Nombre }} ({{ item.Tipo }})
                </option>
                {% endfor %}
            </select>
        </div>

        <div id="edit-form" style="display: none;">
            <div class="form-group">
                <label for="tipo">Tipo:</label>
                <select id="tipo" name="tipo" required>
                    <option value="">Selecciona un tipo</option>
                    <option value="Película">Película</option>
                    <option value="Serie">Serie</option>
                </select>
            </div>

            <div class="form-group">
                <label for="nombre">Nombre:</label>
                <input type="text" id="nombre" name="nombre" placeholder="Introduce el nombre" required>
            </div>

            <div class="form-group">
                <label for="genero">Género:</label>
                <input type="text" id="genero" name="genero" placeholder="Introduce el género">
            </div>

            <div class="form-group">
                <label for="calificacion">Calificación:</label>
                <input type="number" id="calificacion" name="calificacion" step="0.1" min="0" max="10" placeholder="0.0 - 10.0">
            </div>

            <div class="form-group">
                <label for="visto">Visto:</label>
                <select id="visto" name="visto">
                    <option value="">Selecciona</option>
                    <option value="si">Sí</option>
                    <option value="no">No</option>
                </select>
            </div>

            <div class="form-group">
                <label for="nota">Nota:</label>
                <textarea id="nota" name="nota" rows="4" placeholder="Añade una nota opcional"></textarea>
            </div>
            
            <button type="submit">Actualizar</button>
        </div>
    </form>

</div>

{% block script %} <script>
function loadItemData() {
    const select = document.getElementById('id');
    const selectedOption = select.options[select.selectedIndex];
    const editForm = document.getElementById('edit-form');
    
    if (selectedOption.value === '') {
        editForm.style.display = 'none';
        return;
    }
    
    // Mostrar el formulario
    editForm.style.display = 'block';
    
    // Cargar los datos en los campos
    document.getElementById('tipo').value = selectedOption.dataset.tipo;
    document.getElementById('nombre').value = selectedOption.dataset.nombre;
    document.getElementById('genero').value = selectedOption.dataset.genero;
    document.getElementById('calificacion').value = selectedOption.dataset.calificacion;
    document.getElementById('visto').value = selectedOption.dataset.visto;
    document.getElementById('nota').value = selectedOption.dataset.nota;
}
</script>
{% endblock %}

{% endblock %}