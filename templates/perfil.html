{% extends "base.html" %}
{% block title %}Perfil - {{ usuario.username }}{% endblock %}

{% block content %}


<div class="perfil-container">
    <!-- Header del perfil -->
    <div class="perfil-header">
        <h1>
            üë§ 
            {{ usuario.username }}
            <span class="username-badge">Usuario</span>
        </h1>
        <p style="margin: 0; opacity: 0.9;">Miembro desde siempre üé¨</p>
    </div>
    
    <!-- Estad√≠sticas -->
    <div class="stats-container">
        <div class="stat-card">
            <div class="stat-icon">üìä</div>
            <div class="stat-value">{{ estadisticas.total }}</div>
            <div class="stat-label">Valoraciones Totales</div>
        </div>
    </div>
    
    <!-- Secci√≥n de valoraciones -->
    <div class="valoraciones-section">
        <h2>üé¨ Mis Valoraciones</h2>
        
        {% if valoraciones %}
            {% for valoracion in valoraciones %}
            <div class="valoracion-item">
                <div class="valoracion-header">
                    <div class="pelicula-info">
                        <div class="pelicula-nombre">
                            {{ valoracion.pelicula_nombre if valoracion.pelicula_nombre else 'Pel√≠cula #' + valoracion.pelicula_id|string }}
                        </div>
                    </div>
                    <div class="valoracion-puntuacion">
                        <span class="stars">‚≠ê</span>
                        <span class="puntuacion-numero">{{ valoracion.puntuacion }}</span>
                    </div>
                </div>
                
                {% if valoracion.comentario %}
                <div class="valoracion-comentario">
                    "{{ valoracion.comentario }}"
                </div>
                {% endif %}
                
                <div class="valoracion-footer">
                    <div class="valoracion-fecha">
                        üìÖ {{ valoracion.fecha if valoracion.fecha else 'Fecha no disponible' }}
                    </div>
                    <div class="valoracion-acciones">
                        <!-- Bot√≥n para editar - redirige a edit_netflix con el ID -->
                        <a href="/edit_netflix?id={{ valoracion.id }}" class="btn-editar" title="Editar valoraci√≥n">‚úèÔ∏è Editar</a>
                        
                        <!-- Formulario para borrar -->
                        <form method="post" action="/perfil/borrar_valoracion/{{ valoracion.id }}" style="display: inline;" onsubmit="return confirm('¬øEst√°s seguro de que quieres eliminar esta valoraci√≥n? La pel√≠cula permanecer√° en el cat√°logo.')">
                            <button type="submit" class="btn-borrar" title="Borrar valoraci√≥n">üóëÔ∏è Borrar</button>
                        </form>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="no-valoraciones">
                <div class="no-valoraciones-icon">üé≠</div>
                <p>A√∫n no has valorado ninguna pel√≠cula o serie</p>
                <a href="/netflix" class="btn-add-valoracion">Ver cat√°logo</a>
            </div>
        {% endif %}
    </div>
</div>

{% endblock %}